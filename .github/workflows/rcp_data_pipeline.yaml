name: update_rcp_data

on:
    push:
        branches: ["**"]
    schedule:
        - cron: '0 12 1 * *' # Run once a month on the first

jobs:
    update_rcp_data_job:
        name: RCP Data Pipeline
        runs-on: ubuntu-latest

        steps:
            - name: Setup Environment
              uses: actions/setup-python@v2
              with:
                  python-version: '3.11.3'

            - name: Install Python Dependencies
              run: |
                  pip install requests

            - name: Get Repository from GitHub
              uses: actions/checkout@v2
              with:
                ref: exploring-climate-projections


            - name: Change Directories into RCP_Sandbox_Datafiles
              run: |
                  cd ./sandboxdata/RCP_Sandbox_Datafiles/

            - name: Download RCP Data using update_rcp_data.py
              run: |
                  python3 /home/runner/work/sandbox/sandbox/src/scripts/update_rcp_data.py

            - name: Setup git config as "GitHub Actions Bot"
              run: |
                git config user.name "GitHub Actions Bot"
                git config user.email "<>"

            - name: Commit and Push Updated Data
              run: |
                  timestamp=$(date +'%c')
                  git add /home/runner/work/sandbox/sandbox/sandboxdata/RCP_Sandbox_Datafiles/
                  git commit -m "Updated RCP Datafiles: $timestamp"
                  git push --force